<?phpif(!isset($_POST['submit'])){	//This page should not be accessed directly. Need to submit the form.	echo "error: you need to submit the form!";}$amount = $_POST['amount'];$name = $_POST['name'];$donor_email = $_POST['email'];$phone = $_POST['phone'];$address = $_POST['address'];$city = $_POST['city'];$state = $_POST['state'];$postal = $_POST['postal'];$country = $_POST['country'];$notes = $_POST['notes'];$referral = $_POST['referral'];$email_list = $_POST['email-list'];$donate_anonymous = $_POST['donate-anonymous'];$no_gift = $_POST['no-gift'];$gift_listing = $_POST['gift-listing'];$gift_viewtrailer = $_POST['gift-viewtrailer'];$gift_viewfilm = $_POST['gift-viewfilm'];$gift_posterdownload = $_POST['gift-posterdownload'];$gift_dvd = $_POST['gift-dvd'];$gift_signedposter = $_POST['gift-signedposter'];$gift_specialthanks = $_POST['gift-specialthanks'];$gift_imdbthanks = $_POST['gift-imdbthanks'];$gift_thankyoucall = $_POST['gift-thankyoucall'];$gift_calendar = $_POST['gift-calendar'];$gift_cards = $_POST['gift-cards'];$gift_uspremiere = $_POST['gift-uspremiere'];$gift_spainpremiere = $_POST['gift-spainpremiere'];$gift_premierevip = $_POST['gift-premierevip'];$gift_feedbackgroup = $_POST['gift-feedbackgroup'];$gift_consultantcredit = $_POST['gift-consultantcredit'];$gift_imdbconsultant = $_POST['gift-imdbconsultant'];$gift_skypesession = $_POST['gift-skypesession'];$gift_screening = $_POST['gift-screening'];$gift_flightpdx = $_POST['gift-flightpdx'];$gift_nightstay = $_POST['gift-2nightstay'];$gift_execproducer = $_POST['gift-execproducer'];$gift_imdbexecproducer = $_POST['gift-imdbexecproducer'];//Validate firstif(empty($amount)) {    echo "Please enter a donation amount";    exit;}if(empty($name)||empty($donor_email)||empty($phone)||empty($address)||empty($city)||empty($state)||empty($postal)||empty($country)) {    echo "Name, email, phone number and address are mandatory!";    exit;}if(empty($referral)) {    echo "Please let us know how you heard about the film/campaign";    exit;}if(IsInjected($donor_email)){    echo "Invalid email value!";    exit;}$email_from = "$donor_email";//<== update the email address$email_subject = "Receipt of Donation to Future Educational Films, Inc.";$email_body = "THANK YOU for your generous donation. Your contribution brings us that much closer to finishing our film. With your help, The Camino Documentary will share the spirit of the Camino de Santiago with millions around the world!\n \n".	"This confirms your pledge to donate and your selected donor gifts. You will receive an additional email confirming your selected payment method and completion of the donation process.\n \n".	"Please review the following information:\n \n".		"Donation Receipt for: $name \n".    "Donation amount: $ $amount \n".    "Email: $donor_email \n".    "Phone: $phone \n".    "Street Address: $address \n".    "City: $city \n".    "State/Province/Region: $state \n".    "Postal/Zip Code: $postal \n".    "Country: $country \n \n".    "Donor gifts chosen: $no_gift \n $gift_listing $gift_viewtrailer $gift_viewfilm $gift_posterdownload $gift_dvd $gift_signedposter $gift_specialthanks $gift_imdbthanks $gift_thankyoucall $gift_calendar $gift_cards $gift_uspremiere $gift_spainpremiere $gift_premierevip $gift_feedbackgroup $gift_consultantcredit $gift_imdbconsultant $gift_skypesession $gift_screening $gift_flightpdx $gift_nightstay $gift_execproducer $gift_imdbexecproducer \n \n".    "Special Notes: $notes \n".    "How did you hear about us? $referral \n".    "$email_list \n".    "$donate_anonymous \n \n".		"GIFT DELIVERY\n".	"Redeeming of donor gifts varies according to the item. Any gift involving material goods – such as calendars, cards, posters and digital/DVD copies of the finished documentary will not be sent until after the film’s release. Other gifts, such as website acknowledgements and thank-you calls will occur after the Power of One campaign’s end.\n \n".	"TAX INFORMATION\n".	"The Camino Documentary is an independent production of Future Educational Films, Inc. – a 501(c)(3) non-profit. Any individual donation amount above the cost to create your gift(s) is tax-deductible to the donor as a charitable income tax deduction in the United States, to the extent allowed by law. Please keep this acknowledgment of your donation for your tax records (tax ID# 94-2882934).\n \n".	"Once again, thank you for supporting our project.\n \n".	"Sincerely,\n \n".	"The Camino Documentary Team \n".	"Future Educational Films, Inc.\n".	"1327 SE Tacoma St. #208\n".	"Portland, OR, USA 97202\n".	"1-503-206-4968\n".	"\n ";    $to = "$donor_email";//<== update the email address$headers = "From: caminodoc@gmail.com \r\n";$headers .= "Reply-To: caminodoc@gmail.com \r\n";$headers .= "Bcc: caminodoc@gmail.com \r\n";if($_SESSION['security_code'] == $_POST['security_code']){		//Send the email!	$success = mail($to,$email_subject,$email_body,$headers);		if ($success){//done. redirect to thank-you page.     echo('          <div class="span6">        <h3><font style="color:#6b6a66;">Step 1: Your donation and contact information</font>            <br />&nbsp;&nbsp;&nbsp;Step 2: Payment method</h3>		<h2>Donation Amount: $'.$amount.'</h2>		<p>Please select one of the three donation methods below. You may give via Paypal (no account required), by bank (transfer or direct-deposit), or by mailing us a check.</p>		<p><center>			<form action="https://www.paypal.com/cgi-bin/webscr" method="post" class="payment-options">			<input type="hidden" name="cmd" value="_donations">			<input type="hidden" name="business" value="L3PR5D2E3H37W">			<input type="hidden" name="lc" value="US">			<input type="hidden" name="item_name" value="The Camino Documentary">			<input type="hidden" name="amount" value="'.$amount.'">			<input type="hidden" name="currency_code" value="USD">			<input type="hidden" name="no_note" value="1">			<input type="hidden" name="no_shipping" value="1">			<input type="hidden" name="rm" value="1">			<input type="hidden" name="return" value="http://www.caminodocumentary.org/thankyou_paypal.php">			<input type="hidden" name="cancel_return" value="http://www.caminodocumentary.org/get_involved.php">			<input type="hidden" name="currency_code" value="USD">			<input type="hidden" name="bn" value="PP-DonationsBF:btn_donate_now.gif:NonHosted">			<input id="btn_paypal" type="image" src="http://www.caminodocumentary.org/images/clear.gif" width="208" height="55" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">			<img alt="" border="0" src="https://www.paypal.com/en_US/i/scr/pixel.gif" width="1" height="1">			</form>		</center></p>		<p><center>			<form action="get_involved.php?page=donation-form/confirm_mail.php" method="post" class="payment-options">			<input type="hidden" name="amount" value="'.$amount.'">			<input type="hidden" name="name" value="'.$name.'">			<input type="hidden" name="donor_email" value="'.$donor_email.'">			<input type="hidden" name="phone" value="'.$phone.'">			<input id="btn_donate-mail" type="image" src="http://www.caminodocumentary.org/images/clear.gif" width="208" height="55" border="0" name="submit" alt="Give by Bank Transfer">			</form>		</center></p>		<p><center>			If you prefer to donate via bank transfer, please contact as by email: info@caminodocumentary.org.		</center></p>        <p>The Camino Documentary is an independent production of Future Educational Films, Inc. - a 501(c)(3) non-profit. Any individual donation amount above the cost to create your gift(s) is tax-deductible to the donor as a charitable income tax deduction in the United States, to the extent allowed by law.  </p></div>	'."\n"); 	}}else  	{		echo '<h2>Oops, the Form Did Not Submit</h2>			<p>Something went wrong. Please go back and re-submit the form. Make sure the CAPTCHA was fille dout correctly.</p>';	  	} // Function to validate against any email injection attemptsfunction IsInjected($str){  $injections = array('(\n+)',              '(\r+)',              '(\t+)',              '(%0A+)',              '(%0D+)',              '(%08+)',              '(%09+)'              );  $inject = join('|', $injections);  $inject = "/$inject/i";  if(preg_match($inject,$str))    {    return true;  	}  else  	{	return false;	  	}}   ?> 